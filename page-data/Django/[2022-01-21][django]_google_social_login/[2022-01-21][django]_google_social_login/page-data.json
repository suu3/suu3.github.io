{"componentChunkName":"component---src-templates-blog-post-js","path":"/Django/[2022-01-21][django]_google_social_login/[2022-01-21][django]_google_social_login/","result":{"data":{"site":{"siteMetadata":{"title":"Suu.Blog"}},"markdownRemark":{"id":"e2e6563e-27a3-5bee-bac6-b414ec926c16","excerpt":"개요 장고 프로젝트를 진행하면서 구글 소셜 로그인을 맡게 되었다. 구글 로그인에는 allauth를 사용하는 방법 social-auth-app-django를 이용하는 방법 두 가지가 있다. 결론부터 말하면 1번대로 했다가 생각대로 안 되는 부분이 있어서 나는 2번 방법을 사용했다.…","html":"<h2 id=\"개요\" style=\"position:relative;\"><a href=\"#%EA%B0%9C%EC%9A%94\" aria-label=\"개요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>개요</h2>\n<p>장고 프로젝트를 진행하면서 구글 소셜 로그인을 맡게 되었다.</p>\n<p>구글 로그인에는</p>\n<ol>\n<li><strong>allauth를 사용하는 방법</strong></li>\n<li><strong>social-auth-app-django를 이용하는 방법</strong></li>\n</ol>\n<p>두 가지가 있다.</p>\n<p>결론부터 말하면 1번대로 했다가 생각대로 안 되는 부분이 있어서 나는 <strong>2번 방법</strong>을 사용했다.</p>\n<h2 id=\"0-공통-google-api-발급받기\" style=\"position:relative;\"><a href=\"#0-%EA%B3%B5%ED%86%B5-google-api-%EB%B0%9C%EA%B8%89%EB%B0%9B%EA%B8%B0\" aria-label=\"0 공통 google api 발급받기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>0. 공통: google API 발급받기</strong></h2>\n<p><a href=\"https://console.cloud.google.com/\"><strong>구글 클라우드</strong></a>에서 API 키를 발급 받을 수 있다.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30.37974683544304%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA70lEQVR42p2QQUsDMRCF9/9f9CAiWC9e/AciirUUBMF6qXc9uZa21GzDbjIzmzxntrvoHrw48MF7k/BmkuLoeoWTuw0uHx2mrxs8PH9gsXjDcvmOm5cdJnOPi/ke57MfJsrZdI/j2wOn9+pnDldPHkXigJwFKbWgxiNLBIUGFCPaVjCu3PNXZRRbV2O9dXC7CuvPFWrvNTxpWEIkRmQdpLD0XqG+N0JaiFIwEwwRRlmWqKqqCzSibiki+oLcbczM2s/qE0iDDz5156abJqAYlrUD577ARF2IYZcGHUIYedODt68JgVDXvwKHKYbp//INn9/MBM//zH0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"1.png\"\n        title=\"\"\n        src=\"/static/48aa7d4b266e04567e5bf466408c7d3a/f058b/1.png\"\n        srcset=\"/static/48aa7d4b266e04567e5bf466408c7d3a/c26ae/1.png 158w,\n/static/48aa7d4b266e04567e5bf466408c7d3a/6bdcf/1.png 315w,\n/static/48aa7d4b266e04567e5bf466408c7d3a/f058b/1.png 630w,\n/static/48aa7d4b266e04567e5bf466408c7d3a/40601/1.png 945w,\n/static/48aa7d4b266e04567e5bf466408c7d3a/78612/1.png 1260w,\n/static/48aa7d4b266e04567e5bf466408c7d3a/e8950/1.png 2000w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\n사진에서 3번까지 수행하면 client id와 key를 발급받을 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/bb2c8fba18d30109f286040125713a10/e8950/2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 85.44303797468356%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABSklEQVR42q1U2W6DMBDk/78uFa8hEEoIJFwx2NjmmO5uU6lvIYelke/xerzjYDQG2XeGNE1RnM9Ijxm62w1xHMt4khyRnU4IwxBaazwqgXMOTdOg7ToMg4ZSCn0/EHrqDwJttNTzPD8mnKcJg/7dICTU9jT2agmcd5uusplQ9QqnPMdoLV3NCP6ifBbLsnCEHkVZoKoqNITickFOjzPRAtZsK3g9cwXM6vwE63iAJv4teBbruiKY5gVlY5FXFq1yWNblPQ2Z1d9PmO+nvEWIDxchZB05Mga3WcNXIw0MuSCJE0RRJOmTk80O0QH7aC922+2+JOm3J7aztKG/O2WAMSMs5SRryjWDo95MyBvH0QgMJbShmvPpZQ2ZoG27zz0K26woS/Ezfw6KcKMf51nb8a34MUlDj7NYr0ZT17hcr3IAT7J2W8EO897jB+d1N4L3PR6XAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2/img.png\"\n        title=\"\"\n        src=\"/static/bb2c8fba18d30109f286040125713a10/f058b/2.png\"\n        srcset=\"/static/bb2c8fba18d30109f286040125713a10/c26ae/2.png 158w,\n/static/bb2c8fba18d30109f286040125713a10/6bdcf/2.png 315w,\n/static/bb2c8fba18d30109f286040125713a10/f058b/2.png 630w,\n/static/bb2c8fba18d30109f286040125713a10/40601/2.png 945w,\n/static/bb2c8fba18d30109f286040125713a10/78612/2.png 1260w,\n/static/bb2c8fba18d30109f286040125713a10/e8950/2.png 2000w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>일단 사진과 같이 넣고, 후에 오류가 뜬다면 리디렉션 URI를 수정해야 한다. 관련 부분은 뒤에서 서술하도록 하겠다.</p>\n<h2 id=\"1-allauth\" style=\"position:relative;\"><a href=\"#1-allauth\" aria-label=\"1 allauth permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>1. allauth</strong></h2>\n<p>먼저 패키지를 설치한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">pip install django<span class=\"token operator\">-</span>allauth</code></pre></div>\n<p><strong>1. settings.py</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">INSTALLED_APPS <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token string\">'django.contrib.sites'</span><span class=\"token punctuation\">,</span>\n\n<span class=\"token comment\">#allauth'allauth',</span>\n    <span class=\"token string\">'allauth.account'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'allauth.socialaccount'</span><span class=\"token punctuation\">,</span>\n\n<span class=\"token comment\">#provider'allauth.socialaccount.providers.google',</span>\n<span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\nAUTHENTICATION_BACKENDS <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token string\">'django.contrib.auth.backends.ModelBackend'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'allauth.account.auth_backends.AuthenticationBackend'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span>\n\nSITE_ID <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\nLOGIN_REDIRECT_URL <span class=\"token operator\">=</span> <span class=\"token string\">'/'</span></code></pre></div>\n<p>migrate를 해줘야한다.</p>\n<p><strong>2. urls.py</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\nurlpatterns <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    path<span class=\"token punctuation\">(</span><span class=\"token string\">'accounts/'</span><span class=\"token punctuation\">,</span> include<span class=\"token punctuation\">(</span><span class=\"token string\">'allauth.urls'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<p>여기서 accounts/는 원하는 url대로 설정해줘도 된다. (구글 웹 애플리케이션 키 발급받을 때 redirect url에만 맞게 넣어주면 된다.)</p>\n<p><strong>3. db</strong></p>\n<p>admin 계정으로 db에 들어가면 <strong>sites와 social accounts가</strong> 새로 생겼을 것이다.</p>\n<p><strong>sites</strong>에 들어가 보면 기본적으로 example이 생성되어 있는데, example을 127.0.0.1:8000로 수정하거나 새로 127.0.0.1:8000를 추가한다.</p>\n<p>display와 도메인 이름에 127.0.0.1:8000을 적어준다.\nlocalhost 주소를 추가했을 때 example을 수정했다면 위의 settings.py에서 SITE_ID를 1로,</p>\n<p>그다음 <strong>Social applications-Add social application</strong>으로 들어가 새로 앱을 추가해준다.</p>\n<p>provider를 google로 설정하고, id와 secret key를 0번에서 발급받은 키로 넣는다.\nsites에는 127.0.0.1:8000를 추가한다.</p>\n<p><strong>4. html</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">{</span><span class=\"token operator\">%</span> load socialaccount <span class=\"token operator\">%</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span><span class=\"token operator\">%</span> providers_media_js <span class=\"token operator\">%</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token operator\">&lt;</span>a href<span class=\"token operator\">=</span><span class=\"token string\">\" {% provider_login_url 'google' %}\"</span><span class=\"token operator\">></span>구글 로그인<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>a<span class=\"token operator\">></span></code></pre></div>\n<p>여기까지 끝. 만약 <strong>Error: redirect_uri_mismatch</strong> 가 뜬다면 설정해야 할 redirect URI 주소까지 알려준다.</p>\n<p><strong>redirect URI in request</strong>~ 에 나온 주소를 0번의 <strong>승인된 리다이렉션 URI</strong>에 추가한다.</p>\n<h3 id=\"1-1-여기까지-왔을-때-내-문제-\" style=\"position:relative;\"><a href=\"#1-1-%EC%97%AC%EA%B8%B0%EA%B9%8C%EC%A7%80-%EC%99%94%EC%9D%84-%EB%95%8C-%EB%82%B4-%EB%AC%B8%EC%A0%9C-\" aria-label=\"1 1 여기까지 왔을 때 내 문제  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>1-1. 여기까지 왔을 때 내 문제 🤔</strong></h3>\n<p>나는 구글 로그인 버튼을 누르면 바로 이 화면이 나오길 원했는데 🔽</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4feef2ec21be47677c20edb620c4ba41/e8950/3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 104.43037974683544%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACF0lEQVR42o1UWW7bMBDNfXqCnion6GfP0mv0KyfoR42iQGJXlu1IlkSKpMTtdYYWg8ShlwEeSI6oNzOc5QGLBO/hrIO19g3zbOGcQ4zxLrA8ZEKtBPpeoG1aHI9HtO0RXdeRboAnYyGEm3gjZPasyJayvLd+zbtPhOdEWdg7rQ2maU7hX5IQ4i3C09lohdVqhefnFwq/L0ZxkzDvjA2o2oD6VeL1sEPTNpBSFkmLhKwzc4QmGBuhpghpGB5SW4wThT+H9I2hCdbHMiH7NZiApnfoRk8IaKWH0AGKDIwziDB+ABs8qgAfzsomHxoiGI1NIXtKGhvny+zFOWYX07eWDPMeseAhe/Wntlg3DpuWQGvVueT5QJ6mNe8JPUFOIXHF0huyRaFP78bvqCmkyUbcI+WkUHHGQF3hHe09vLOnLqD4uRW5JhmWWtQte15jOSmAFAL1dofN5h92uz3qaotdvcf6ZU1rjeZwQEU61q83FfaHFqMylzwEdYKFGseEkSDlCGMMhkGks1p0Wim4aURw8/WQObPWE2gNV56O7zz9dfj5e8avyl2uQ85Y3XtsO5+6hHXx3ZOE5R6X19fvB3z5tsfjj1M7+tu9fCWjdHUvqC3JcK/jvcPhs8R7y+bWrCuBQ0zwhYnNtcZTWlH2LglPGc443xViIAjK/pA801qnmvwQsnNUoMvULQkP1/xTLnBPDRAXh7KH/wH26nHyvjXs8wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img.png\"\n        title=\"\"\n        src=\"/static/4feef2ec21be47677c20edb620c4ba41/f058b/3.png\"\n        srcset=\"/static/4feef2ec21be47677c20edb620c4ba41/c26ae/3.png 158w,\n/static/4feef2ec21be47677c20edb620c4ba41/6bdcf/3.png 315w,\n/static/4feef2ec21be47677c20edb620c4ba41/f058b/3.png 630w,\n/static/4feef2ec21be47677c20edb620c4ba41/40601/3.png 945w,\n/static/4feef2ec21be47677c20edb620c4ba41/78612/3.png 1260w,\n/static/4feef2ec21be47677c20edb620c4ba41/e8950/3.png 2000w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>버튼을 눌렀을 때 이 화면이 먼저 나왔고 Continue를 눌러야 인증으로 넘어갔다. 🔽</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4cc3d0cb56076543b6bf5ffa15b5dbba/e8950/4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49.36708860759494%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAvUlEQVR42r2SSw+CMBCE+/9/kw/OkqBoghcucrEcSsGWbYG0Y0UuHjSBEDeZTLKHL7MPVhQF+q7HWsXalsBvAqTsu+Mn834Z0BiDRmjoB2EYBjjnPjQbGEV7HNMUeZ7jlCTIsisOcYzddoP0fJkPrKWEEBWU0miaOqiBDL2yLCEqAUMGrym0bkFBSis4/z0543cOzktYa0GGYKwBEcF23egUdjz6BB6BP1bBZFWNqVa7MlYu5sOfLH2RvyR8AiohEs3nVqkaAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img.png\"\n        title=\"\"\n        src=\"/static/4cc3d0cb56076543b6bf5ffa15b5dbba/f058b/4.png\"\n        srcset=\"/static/4cc3d0cb56076543b6bf5ffa15b5dbba/c26ae/4.png 158w,\n/static/4cc3d0cb56076543b6bf5ffa15b5dbba/6bdcf/4.png 315w,\n/static/4cc3d0cb56076543b6bf5ffa15b5dbba/f058b/4.png 630w,\n/static/4cc3d0cb56076543b6bf5ffa15b5dbba/40601/4.png 945w,\n/static/4cc3d0cb56076543b6bf5ffa15b5dbba/78612/4.png 1260w,\n/static/4cc3d0cb56076543b6bf5ffa15b5dbba/e8950/4.png 2000w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>찾아봤을 때 다음 글을 참고할 수 있었다.</p>\n<ul>\n<li><a href=\"https://learndjango.com/tutorials/django-log-in-email-not-username\"><strong>template 커스텀 방법까지 나와있는 참고 사이트</strong></a></li>\n<li><a href=\"https://github.com/pennersr/django-allauth/issues/345\"><strong>관련 Issue</strong></a></li>\n</ul>\n<p>위 글들을 참고했을 때, 나는 바로 소셜로그인 화면으로 바뀌는걸 원했어서 1번은 포기하고 2번 방법으로 넘어갔다. (*2번은 db설정을 해줄 필요가 없어서 좀 더 간편하다.)</p>\n<h2 id=\"2-social-auth-app-django\" style=\"position:relative;\"><a href=\"#2-social-auth-app-django\" aria-label=\"2 social auth app django permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>2. social-auth-app-django</strong></h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">pip install social<span class=\"token operator\">-</span>auth<span class=\"token operator\">-</span>app<span class=\"token operator\">-</span>django</code></pre></div>\n<p>먼저 패키지를 설치해줘야 한다.</p>\n<p><strong>1. settings.py</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n\nINSTALLED_APPS <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'social_django'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n\nAUTHENTICATION_BACKENDS <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\n<span class=\"token comment\">#Needed to login by username in Django admin, regardless of 'allauth''social_core.backends.google.GoogleOAuth2',</span>\n\n<span class=\"token comment\"># 'allauth' specific authentication methods, such as login by e-mail'django.contrib.auth.backends.ModelBackend',</span>\n<span class=\"token punctuation\">)</span>\n\nSOCIAL_AUTH_URL_NAMESPACE <span class=\"token operator\">=</span> <span class=\"token string\">'login:social'</span>\n\nLOGIN_REDIRECT_URL<span class=\"token operator\">=</span><span class=\"token string\">'/'</span><span class=\"token comment\">#소셜 로그인 후 돌아갈 화면</span>\n\nSOCIAL_AUTH_GOOGLE_OAUTH2_KEY <span class=\"token operator\">=</span> <span class=\"token string\">'발급받은 id'</span>\nSOCIAL_AUTH_GOOGLE_OAUTH2_SECRET <span class=\"token operator\">=</span> <span class=\"token string\">'발급받은 비밀키'</span>\nSOCIAL_AUTH_GOOGLE_OAUTH2_SCOPE <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'email'</span><span class=\"token punctuation\">]</span> <span class=\"token comment\"># 이메일로 식별하겠다.</span></code></pre></div>\n<p>작성 후 migrate를 해줘야 한다.</p>\n<p>나는 login이라는 app 안 urls.py에 social url을 추가했기 때문에 <strong>SOCIAL_AUTH_URL_NAMESPACE = 'login:social'라고</strong> 써주었지만, 기본 프로젝트 urls.py에 social url을 추가해줬다면 'social'이라고 적어줘야 한다.</p>\n<p>KEY의 경우 깃헙에 올라가지 않게 안전하게 보관해야 한다는 것을 유의하자. env 설정 방법이 있는데 여기선 생략한다.</p>\n<p><strong>login/urls.py</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> django<span class=\"token punctuation\">.</span>urls <span class=\"token keyword\">import</span> path<span class=\"token punctuation\">,</span> include\n\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n\nurlpatterns <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    path<span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">,</span> include<span class=\"token punctuation\">(</span><span class=\"token string\">'social_django.urls'</span><span class=\"token punctuation\">,</span> namespace<span class=\"token operator\">=</span><span class=\"token string\">'social'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<p>위 path를 어디에 있는 urls.py에 넣냐에 따라 settings.py의 SOCIAL_AUTH_URL_NAMESPACE를 다르게 써줘야 한다는 것을 주의하자.</p>\n<p>구글링 해보면 path대신 url을 쓰는 코드들이 많이 나오는데, url은 장고 최신 버전에서 deprecated 되었기 때문에 path로 작성해줘야 한다.</p>\n<p><strong>html</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&lt;a href=\"{% url 'login:social:begin' 'google-oauth2' %}\">구글 로그인&lt;/a></code></pre></div>\n<p>login app -> social namespace -> begin</p>\n<p>begin은 신경 쓸 필요 없으나 위에서 app 이름과 nampspace를 어떻게 적어줬는지 주의해서 작성하자.\n여기서도 마찬가지로 리다이렉션 시 <strong>Error: redirect_uri_mismatch</strong> 가 뜬다면 <strong>redirect URI in request</strong>~ 에 나온 주소를 0번의 <strong>승인된 리다이렉션 URI</strong>에 추가한다.</p>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%EA%B0%9C%EC%9A%94\">개요</a></p>\n</li>\n<li>\n<p><a href=\"#0-%EA%B3%B5%ED%86%B5-google-api-%EB%B0%9C%EA%B8%89%EB%B0%9B%EA%B8%B0\"><strong>0. 공통: google API 발급받기</strong></a></p>\n</li>\n<li>\n<p><a href=\"#1-allauth\"><strong>1. allauth</strong></a></p>\n<ul>\n<li><a href=\"#1-1-%EC%97%AC%EA%B8%B0%EA%B9%8C%EC%A7%80-%EC%99%94%EC%9D%84-%EB%95%8C-%EB%82%B4-%EB%AC%B8%EC%A0%9C-\"><strong>1-1. 여기까지 왔을 때 내 문제 🤔</strong></a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#2-social-auth-app-django\"><strong>2. social-auth-app-django</strong></a></p>\n</li>\n</ul>","frontmatter":{"title":"[django] google social login 구현하기","date":"2022.01.21","description":"django에서 google social login 구현하는 방법에 대해 알아본다.","category":"Django","tag":["project","django"]}},"previous":{"fields":{"slug":"/Project/[2022-01-16]react-native에서_json_파일_Firebase로_가져오기/[2022-01-16]react-native에서_json_파일_Firebase로_가져오기/"},"frontmatter":{"title":"react-native에서 json 파일 Firebase로 가져오기"}},"next":{"fields":{"slug":"/기타/[2022-04-24]유니티 WebGL 방식으로 gh-pages 배포하기/[2022-04-24]유니티 WebGL 방식으로 gh-pages 배포하기/"},"frontmatter":{"title":"유니티 WebGL 방식으로 gh-pages 배포하기"}}},"pageContext":{"id":"e2e6563e-27a3-5bee-bac6-b414ec926c16","previousPostId":"1baf0fb9-a3d5-503a-9526-43cb5c0808ca","nextPostId":"872a0cbb-7a02-5d00-8754-501746583537"}},"staticQueryHashes":["2841359383"],"slicesMap":{}}